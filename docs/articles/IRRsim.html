<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Relationship between Interclass Correlation (ICC) and Percent Agreement • IRRsim</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">IRRsim</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/IRRsim.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/jbryer/IRRsim">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Relationship between Interclass Correlation (ICC) and Percent Agreement</h1>
                        <h4 class="author">Jason Bryer</h4>
            
            <h4 class="date">2018-02-06</h4>
          </div>

    
    
<div class="contents">
<p>This document outlines a simulation to explore the relationship between percent rater agreement and six variations of interclass correlation (ICC). A number of functions are included in the <code>irr_simulation.R</code> script. To start, let’s look at the <code>simulateRatingMatrix</code> function. This function will generate a <code>nEvents</code> by <code>k</code> matrix. For each row, two columns (which represent raters) are randomly selected and each cell of those cells will randomly have a value between 1 and <code>nLevels</code>. The likelihood of those two cell having the same value is defined by the <code>agree</code> parameter.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test &lt;-<span class="st"> </span><span class="kw"><a href="../reference/simulateRatingMatrix.html">simulateRatingMatrix</a></span>(<span class="dt">nLevels =</span> <span class="dv">3</span>, <span class="dt">k =</span> <span class="dv">6</span>, <span class="dt">agree =</span> <span class="fl">0.6</span>, <span class="dt">nEvents =</span> <span class="dv">10</span>)
test
<span class="co">#&gt;     a  b  c  d  e  f</span>
<span class="co">#&gt; 1  NA NA  1 NA  3 NA</span>
<span class="co">#&gt; 2  NA  1  1 NA NA NA</span>
<span class="co">#&gt; 3  NA  2 NA NA NA  1</span>
<span class="co">#&gt; 4   1 NA NA NA NA  1</span>
<span class="co">#&gt; 5  NA  3 NA NA NA  1</span>
<span class="co">#&gt; 6  NA  1 NA NA NA  1</span>
<span class="co">#&gt; 7   1 NA  2 NA NA NA</span>
<span class="co">#&gt; 8   1  1 NA NA NA NA</span>
<span class="co">#&gt; 9  NA NA NA  3 NA  3</span>
<span class="co">#&gt; 10 NA NA  1 NA  1 NA</span></code></pre></div>
<p>The <code>agreement</code> function will calculate the percent rater agreement for the matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/agreement.html">agreement</a></span>(test)
<span class="co">#&gt; [1] 0.6</span></code></pre></div>
<p>For the remainder of the document, we wish to estimate ICC for 6, 9, and 12 raters under the conditions of 3, 5, and 9 scoring levels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tests.3levels &lt;-<span class="st"> </span><span class="kw"><a href="../reference/simulateICC.html">simulateICC</a></span>(<span class="dt">nRaters =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>), <span class="dt">nLevels =</span> <span class="dv">3</span>)
tests.5levels &lt;-<span class="st"> </span><span class="kw"><a href="../reference/simulateICC.html">simulateICC</a></span>(<span class="dt">nRaters =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>), <span class="dt">nLevels =</span> <span class="dv">5</span>)
tests.9levels &lt;-<span class="st"> </span><span class="kw"><a href="../reference/simulateICC.html">simulateICC</a></span>(<span class="dt">nRaters =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>), <span class="dt">nLevels =</span> <span class="dv">9</span>)</code></pre></div>
<p>Here is a curious artifact of the relationship (you’ll see below that it is quadratic), the percent agreement is uniform (as it should be since we designed the simulation this way), the distribution of ICC1 is positively skewed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(tests.3levels, <span class="kw">aes</span>(<span class="dt">x =</span> agreement)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="IRRsim_files/figure-html/unnamed-chunk-1-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(tests.3levels, <span class="kw">aes</span>(<span class="dt">x =</span> ICC1)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="IRRsim_files/figure-html/unnamed-chunk-1-2.png" width="672"></p>
<p>The following three figures show ICC1 against percent rater agreement with 3, 5, and 9 score levels, respectively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(tests.3levels, <span class="kw">aes</span>(<span class="dt">x =</span> agreement, <span class="dt">y =</span> ICC1, <span class="dt">color =</span> <span class="kw">factor</span>(k))) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">'loess'</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">scale_color_hue</span>(<span class="st">'n Raters'</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="op">-</span><span class="fl">0.25</span>,<span class="dv">1</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">xlab</span>(<span class="st">'Percent Agreement'</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">'ICC1'</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">'ICC1 with 3 scoring levels'</span>)</code></pre></div>
<p><img src="IRRsim_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(tests.5levels, <span class="kw">aes</span>(<span class="dt">x =</span> agreement, <span class="dt">y =</span> ICC1, <span class="dt">color =</span> <span class="kw">factor</span>(k))) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">'loess'</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">scale_color_hue</span>(<span class="st">'n Raters'</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="op">-</span><span class="fl">0.25</span>,<span class="dv">1</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">xlab</span>(<span class="st">'Percent Agreement'</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">'ICC1'</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">'ICC1 with 5 scoring levels'</span>)</code></pre></div>
<p><img src="IRRsim_files/figure-html/unnamed-chunk-2-2.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(tests.9levels, <span class="kw">aes</span>(<span class="dt">x =</span> agreement, <span class="dt">y =</span> ICC1, <span class="dt">color =</span> <span class="kw">factor</span>(k))) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">'loess'</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">scale_color_hue</span>(<span class="st">'n Raters'</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="op">-</span><span class="fl">0.25</span>,<span class="dv">1</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">xlab</span>(<span class="st">'Percent Agreement'</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">'ICC1'</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">'ICC1 with 9 scoring levels'</span>)</code></pre></div>
<p><img src="IRRsim_files/figure-html/unnamed-chunk-2-3.png" width="672"></p>
<p>The figure below show the relationship between percent rater agreement and interclass correlation for the six types of ICC.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tmp &lt;-<span class="st"> </span><span class="kw">melt</span>(tests.3levels[,<span class="kw">c</span>(<span class="st">'i'</span>,<span class="st">'k'</span>,<span class="st">'agreement'</span>,<span class="st">'ICC1'</span>,<span class="st">'ICC2'</span>,<span class="st">'ICC3'</span>,<span class="st">'ICC1k'</span>,<span class="st">'ICC2k'</span>,<span class="st">'ICC3k'</span>)], 
            <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">'i'</span>,<span class="st">'k'</span>,<span class="st">'agreement'</span>))
<span class="kw">ggplot</span>(tmp, <span class="kw">aes</span>(<span class="dt">x =</span> agreement, <span class="dt">y =</span> value, <span class="dt">color =</span> <span class="kw">factor</span>(k))) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">'loess'</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>variable) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_color_hue</span>(<span class="st">'n Raters'</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">xlab</span>(<span class="st">'Percent Agreement'</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">'ICC'</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">'ICC and Percent Rater Agreement (3 scoring levels)'</span>)</code></pre></div>
<p><img src="IRRsim_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>The literature suggests that ICC be used over percent agreement (citations?). However, the figures above suggest there is a strong relationship between percent rater agreement and ICC. Below, we fit a quadratic model predicting ICC1 from percent agreement. In all three cases the result <span class="math inline">\(R^2\)</span> is greater than .89!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm.out3 &lt;-<span class="st"> </span><span class="kw">lm</span>(ICC1 <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(agreement <span class="op">^</span><span class="st"> </span><span class="dv">2</span>), <span class="dt">data =</span> tests.3levels)
<span class="kw">summary</span>(lm.out3)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = ICC1 ~ I(agreement^2), data = tests.3levels)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;       Min        1Q    Median        3Q       Max </span>
<span class="co">#&gt; -0.201414 -0.033691  0.003348  0.030766  0.306830 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)    -0.094769   0.001871  -50.65   &lt;2e-16 ***</span>
<span class="co">#&gt; I(agreement^2)  0.752633   0.004489  167.65   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.06272 on 2698 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.9124, Adjusted R-squared:  0.9124 </span>
<span class="co">#&gt; F-statistic: 2.811e+04 on 1 and 2698 DF,  p-value: &lt; 2.2e-16</span>

lm.out5 &lt;-<span class="st"> </span><span class="kw">lm</span>(ICC1 <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(agreement <span class="op">^</span><span class="st"> </span><span class="dv">2</span>), <span class="dt">data =</span> tests.5levels)
<span class="kw">summary</span>(lm.out5)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = ICC1 ~ I(agreement^2), data = tests.5levels)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;      Min       1Q   Median       3Q      Max </span>
<span class="co">#&gt; -0.24715 -0.03662  0.00506  0.03357  0.32815 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)    -0.049413   0.002102  -23.51   &lt;2e-16 ***</span>
<span class="co">#&gt; I(agreement^2)  0.767413   0.005037  152.34   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.07047 on 2698 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.8959, Adjusted R-squared:  0.8958 </span>
<span class="co">#&gt; F-statistic: 2.321e+04 on 1 and 2698 DF,  p-value: &lt; 2.2e-16</span>

lm.out9 &lt;-<span class="st"> </span><span class="kw">lm</span>(ICC1 <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(agreement <span class="op">^</span><span class="st"> </span><span class="dv">2</span>), <span class="dt">data =</span> tests.9levels)
<span class="kw">summary</span>(lm.out9)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = ICC1 ~ I(agreement^2), data = tests.9levels)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;       Min        1Q    Median        3Q       Max </span>
<span class="co">#&gt; -0.227100 -0.038989  0.002695  0.034725  0.295451 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)    -0.021036   0.002181  -9.646   &lt;2e-16 ***</span>
<span class="co">#&gt; I(agreement^2)  0.774675   0.005238 147.892   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.073 on 2698 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.8902, Adjusted R-squared:  0.8902 </span>
<span class="co">#&gt; F-statistic: 2.187e+04 on 1 and 2698 DF,  p-value: &lt; 2.2e-16</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jason Bryer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
